<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Select Route</title>
</head>
<body>
    <h2>Select a Route</h2>
    <label for="route-selection">Choose Route:</label>
    <select id="route-selection"></select>
    <button onclick="selectRoute()">Load Route</button>
    <button onclick="window.location.href='menu.html'">Back</button>

    <script>
        async function loadRoutes() {
            const driverId = localStorage.getItem("driverId");
            const response = await fetch(`http://localhost:3000/api/scheduled-routes/${driverId}`);
            const data = await response.json();

            if (!data || !Array.isArray(data.scheduled_route)) {
                console.warn("No scheduled routes found.");
                return;
            }
            
            const routeSelection = document.getElementById("route-selection");
            routeSelection.innerHTML = "";
            data.scheduled_route.forEach(route => {
                const option = document.createElement("option");
                option.value = route.route_id;
                option.text = `Route ${route.route_id}`;
                routeSelection.appendChild(option);
            });
        }

        function selectRoute() {
            const selectedRoute = document.getElementById("route-selection").value;
            localStorage.setItem("selectedRoute", selectedRoute);
            window.location.href = "map.html";
        }

        window.onload = function () {
            const driverId = localStorage.getItem("driverId");
            if (!driverId) {
                window.location.href = "/"; 
            }
        };

        window.onload = loadRoutes;
    </script>
</body>
</html>
